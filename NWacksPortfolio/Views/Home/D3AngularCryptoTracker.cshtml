@model NWacksPortfolio.Models.CryptoCurrencyModel

@{
    ViewBag.Title = "D3CryptoTracker";
}

@section scripts
{
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    <script src="~/Scripts/Home/D3AngularCryptoScript.js"></script>
}

@section styles
{
    <link href="~/Content/D3AngularCrypto.css" rel="stylesheet" />
}

<input type="hidden" id="cryptoData" value="@Model.CryptoData" />

<h1>
    Crypto Currency Demo
</h1>

<div id="mainView" style="display:none">
    <!--D3 graph of crypto data-->
    <div class="container">
        <h2>Crypto Currency Graph using D3.js</h2>

        <h3>Current USD value of top 15 most traded currencies</h3>
        <div class="current-value-graph">
        </div>

        <h3>Current USD market cap value of top 15 most traded currencies</h3>
        <div class="market-cap-pie-chart">
        </div>
    </div>

    <!--Angular data table of crypto data-->
    <div class="container">
        <h2>Current Crypto Currency data, displayed using Angular.js</h2>

        <div ng-app="cryptoApp" ng-controller="CryptoController">
            <div class="input-group">
                <label>
                    Currencies per Page:
                    <input type="number" min="5" max="{{currencies.length}}" ng-model="recordsPerPage" ng-change="page=1;" />
                </label>
            </div>
            <div class="input-group">
                <label>
                    Page:
                    <input type="number" min="1" max="{{ceiling(currencies.length / recordsPerPage)}}" ng-model="page" />
                </label>
            </div>

            <table class=" table-striped table">
                <tr>
                    <th>Name</th>
                    <th>Rank</th>
                    <th>Value per Unit</th>
                    <th>Market Cap</th>
                </tr>
                <tr ng-repeat="currency in currencies" ng-show="$index >= ((page - 1) * recordsPerPage) && $index < (page * recordsPerPage)">
                    <td>
                        {{currency.name + ' (' + currency.symbol + ')'}}
                    </td>
                    <td>
                        {{currency.rank}}
                    </td>
                    <td>
                        {{currency.price_usd}}
                    </td>
                    <td>
                        {{currency.market_cap_usd}}
                    </td>
                </tr>
            </table>

            <div class="input-group">
                <label>
                    Page:
                    <input type="number" value="1" min="1" max="" ng-model="page" />
                </label>
            </div>
        </div>
    </div>
</div>
<div id="errorView" style="display:none">
    <!--Display a basic error message-->
    <div class="jumbotron">
        <h2>Sorry, we have encountered an error:</h2>
        <p id="errorMessage"></p>
        <button type="button" class="btn btn-primary" id="retryButton">Retry Default Data Load</button>
    </div>
</div>